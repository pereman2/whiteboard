(this.webpackJsonptutoronline=this.webpackJsonptutoronline||[]).push([[0],{175:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABYSURBVHgB7dpBEQAgDMCwgX/PYKO3Sxz03zMzb5bYEPLuLCGkRkiNkBohNUJqhNQIqRFSI6RGSI2QGiE1QmqE1AipEVIjpEZIjZAaITVCaoTUCKk5s2Q8+0B3BF2mHjcDAAAAAElFTkSuQmCC"},176:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKiSURBVHgB3Zq/WtswFMUPsHRrxm65I1vdrVs9dmvfgLwBeQP8Bm2fgPAEbp8AOnYqfYKajY2wsYFOdJUo+QiJbdmW+H3fRdhWIp1c/fGVdIBwiLHc2HtNR545KrVrtd963ZoDtIOVnBo70f9/wlaw0vTe2NzLP4YVnKnlep+f+4FAouqQG7s0dmfszNgnNIeCzo3911TQA2KsxErACGGZoAdBbEJdCdiEZVDQCQLzXb84Q3+IlvkNAeAv/xfW1V17YVv5pdahcflOxBmGh3VoLCYWEQ4nphbsEyXiY4YafWYC28mG6BO7YJ1Yt+mujKIZBfHCkZPTgLyUiaNTTP1iG6zj1qYvsN5IATYxeiV/7iG9EXwm7RB65XLzpiAdbzicVxaD0pHepLpbY7+QDg/G3hj7CBvXLOj7PSoUObyWJEivWfmweY3ZtL7qjZSalc8x/xzCxtjXSBfWPaOQDGkLuTGWU4hggKA/IHTCYgh+RNq4+SR5IeTxEK8ECuECWoyxRy2ckLdIFzFWOSEpvp44xFjFmf1Yb/xBmnwx9kCP/EPaHllO6AIdhxNlbY2BFznSg95YvLm7eWSGdlsDQ3EKu7eyZC1sTIhls3KhLsPGz8bewQsbI2ei6cXmgxxpeWWtkx95DyrYQJ4PY/dKATuRX2zLILBeiXleEey5rDtF/IvYey8kcun+HPHB9d7aW3HcVCkQDwUabPQQt/VWYHgKBNpHLDHcZugMe4jYFepyiPsAOzTzywT9kWmZd1qHOQIxgR0xCnTLSMuggFN0hGB1biT0XoovoESPZ1L8gzBtJtAcKwHcuGn0Ft72mJPAut8thF/BRmuMOiusr2C6s1sUPdaUn2Pbn8Eec2rcD9oK8RGsDp5lei3e87lnV7CCmd4gAE8P35m66oMsUAAAAABJRU5ErkJggg=="},177:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAADCAYAAAA+2zeHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABDSURBVHgBxcuxCQAgDETRC7iH2cRRHMVV4yYWFjY5NCL4ys+dYGpYOnwGzi4+zyWnFbKt4DTYLdiPPoI/MukKTnd9AJwxCORGX/rjAAAAAElFTkSuQmCC"},179:function(e,t,n){e.exports=n(451)},184:function(e,t,n){},185:function(e,t,n){},186:function(e,t,n){},187:function(e,t,n){},188:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){e.exports=n.p+"static/media/picker_mask.a4d3b14f.png"},374:function(e,t,n){},399:function(e,t){},401:function(e,t){},426:function(e,t,n){},447:function(e,t){},450:function(e,t,n){},451:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),r=n(29),c=n.n(r);n(184),n(185);var i=n(4),s=n(7),l=n(5),u=n(6),h=(n(186),n(187),n(64));n(188);var d=n(92);function f(e,t){return{x:t.clientX,y:t.clientY}}function m(e){return"linear-gradient(to bottom, rgba(255,255,255,1) 0%, rgba(0,0,0,1) "+e+"%)"}var p=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var a;return Object(i.a)(this,n),(a=t.call(this,e,o)).saveWidth=function(e){if(console.log("yee"),"Enter"===e.key)try{var t=a.refs.circle;t.contentEditable="false";var n=parseInt(t.innerHTML,10);if(!isNaN(n)&&n<100){a.setState({width:n});var o=m(100-a.state.width);a.state.circle.style.background=o}t.innerHTML=a.state.width,t.blur(),a.props.onValueChange(e)}catch(r){}},a.editWidth=function(e){var t=a.refs.circle;null!=t&&(t.contentEditable=!0,t.focus())},a.saveLast=function(e,t,n){var o=document.querySelector("#Board"),r=f(0,e),c=o.getBoundingClientRect(),i=t||r.x-c.left,s=n||r.y-c.top;a.setState({lastX:i,lastY:s})},a.mouseDown=function(e){a.setState({isDown:!0}),a.state.circle.focus(),a.saveLast(e)},a.mouseUp=function(e){f(a.state.circle,e);a.setState({isDown:!1})},a.mouseMove=function(e){if(a.state.isDown){var t=f(a.state.circle,e),n=a.state.lastY-t.y,o=(n=parseInt(.1*n,10),a.state.width+n);if(o<100&&o>0){a.setState({width:o});var r=m(100-a.state.width);a.state.circle.style.background=r;r=m(100-o);a.state.circle.style.background=r,a.onValueChange(Object(h.a)(a))}}},a.onValueChange=function(e){a.props.onValueChange(e)},a.state={width:a.props.width},console.log(a.props),a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.refs.circle,t=this.refs.pixels;this.setState({circle:e}),t.contentEditable="false"}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"CircleWidth"},a.a.createElement("div",{ref:"circle",onMouseUp:function(t){return e.mouseUp(t)},onMouseMove:function(t){return e.mouseMove(t)},onMouseDown:function(t){return e.mouseDown(t)},className:"brush-circle"},a.a.createElement("div",{ref:"pixels",className:"width-circle"},this.state.width)))}}]),n}(a.a.Component),v=(n(353),n(354),n(452),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var a;return Object(i.a)(this,n),(a=t.call(this,e,o)).handleChangeComple=function(e){a.setState({background:e.hex}),a.eventColor(e)},a.eventColor=function(e){a.props.onColorChange(e)},a.state={background:"#fff"},a}return Object(s.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{className:"ColorPicker"},a.a.createElement(d.ChromePicker,{color:this.state.background,onChangeComplete:this.handleChangeComple}))}}]),n}(a.a.Component)),g=n(65),A=n.n(g),C=function e(t,n,o,a){if(Object(i.a)(this,e),this.setWidth=function(e){this.width=e},this.getWidth=function(){return this.width},this.getContext=function(){return this.ctx},this.getCanvas=function(){return this.canvas},this.setMode=function(e){this.mode=e},this.setColor=function(e){this.color=e},this.setPosActual=function(e){this.posActual=e},this.setPosAnterior=function(e){this.posAnterior=e},this.updateLine=function(e){this.setPosAnterior(this.posActual),this.setPosActual(e)},this.setCanvas=function(e){this.ctx=e.getContext("2d"),this.canvas=e},"object"!=typeof o||"object"!=typeof a)throw new Error("Posicion formato incorrecto( {x:x,y:y})");this.width=t,this.color=n,this.posActual=o,this.posAnterior=a},w=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o,a,r){var c;return Object(i.a)(this,n),(c=t.call(this,e,o,a,r)).draw=function(){if(!this.canvas)throw new Error("No se ha asignado un canvas a la linea");var e=this.canvas.getBoundingClientRect(),t=this.posActual.x-e.left,n=this.posActual.y-e.top,o=this.posAnterior.x,a=this.posAnterior.y;this.ctx.globalCompositeOperation="destination-out",this.ctx.moveTo(t,n),this.ctx.lineTo(o,a),this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth=this.width,this.ctx.strokeStyle=this.color,this.ctx.stroke()},c}return n}(C),k=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o,a,r){var c;return Object(i.a)(this,n),(c=t.call(this,e,o,a,r)).draw=function(){if(!this.canvas)throw new Error("No se ha asignado un canvas a la linea");var e=this.canvas.getBoundingClientRect(),t=this.posActual.x-e.left,n=this.posActual.y-e.top,o=this.posAnterior.x,a=this.posAnterior.y;this.ctx.globalCompositeOperation="source-over",this.ctx.moveTo(t,n),this.ctx.lineTo(o,a),this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth=this.width,this.ctx.strokeStyle=this.color,this.ctx.stroke()},c}return n}(C),b=function(){function e(t,n,o){if(Object(i.a)(this,e),"object"!=typeof o)throw new Error("Posicion formato incorrecto( {x:x,y:y})");this.width=t,this.color=n,this.posActual=o}return Object(s.a)(e,[{key:"setWidth",value:function(e){this.width=e}},{key:"getWidth",value:function(){return this.width}},{key:"getContext",value:function(){return this.ctx}},{key:"getCanvas",value:function(){return this.canvas}},{key:"setMode",value:function(e){this.mode=e}},{key:"setColor",value:function(e){this.color=e}},{key:"setPosActual",value:function(e){this.posActual=e}},{key:"setPosAnterior",value:function(e){this.posAnterior=e}},{key:"actualizarPos",value:function(e){this.setPosAnterior(this.posActual),this.setPosActual(e)}},{key:"setCanvas",value:function(e){this.ctx=e.getContext("2d"),this.canvas=e}}]),e}(),x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o,a){return Object(i.a)(this,n),t.call(this,e,o,a)}return Object(s.a)(n,[{key:"draw",value:function(){if(!this.canvas)throw new Error("No se ha asignado un canvas a la linea");this.setAttributes(),this.makeRect(),this.ctx.stroke()}},{key:"makeRect",value:function(){var e=this.canvas.getBoundingClientRect(),t=this.posActual.x-e.left,n=this.posActual.y-e.top,o=this.posAnterior.x,a=this.posAnterior.y,r=n-a,c=t-o;this.ctx.moveTo(t,n),this.ctx.rect(o,a,c,r)}},{key:"setAttributes",value:function(){this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth=this.width,this.ctx.strokeStyle=this.color}}]),n}(b),E=0*Math.PI,y=2*Math.PI,O=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o,a){return Object(i.a)(this,n),t.call(this,e,o,a)}return Object(s.a)(n,[{key:"draw",value:function(){if(!this.canvas)throw new Error("No se ha asignado un canvas a la linea");this.setAttributes(),this.makeCircle(),this.ctx.stroke()}},{key:"makeCircle",value:function(){var e=this.getCenter();this.ctx.arc(e.x,e.y,e.radius,E,y)}},{key:"getCenter",value:function(){var e=this.canvas.getBoundingClientRect(),t=this.posActual.x-e.left,n=this.posActual.y-e.top,o=this.posAnterior.x,a=this.posAnterior.y;return{x:(t+o)/2,y:(n+a)/2,radius:(n-a)/2}}},{key:"setAttributes",value:function(){this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth=this.width,this.ctx.strokeStyle=this.color}}]),n}(b),S=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o,a){return Object(i.a)(this,n),t.call(this,e,o,a)}return Object(s.a)(n,[{key:"draw",value:function(){if(!this.canvas)throw new Error("No se ha asignado un canvas a la linea");this.setAttributes(),this.makeStraightLine(),this.ctx.stroke()}},{key:"makeStraightLine",value:function(){var e=this.canvas.getBoundingClientRect(),t=this.posActual.x-e.left,n=this.posActual.y-e.top,o=this.posAnterior.x,a=this.posAnterior.y;this.ctx.moveTo(t,n),this.ctx.lineTo(o,a)}},{key:"setAttributes",value:function(){this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth=this.width,this.ctx.strokeStyle=this.color}}]),n}(b),P=(n(374),n(175)),B=n.n(P),j=n(176),D=n.n(j),R=n(177),I=n.n(R),T=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var r;return Object(i.a)(this,n),(r=t.call(this,e,o)).handleClick=function(e){r.state.popupOn?r.popup.current.style.display="none":r.popup.current.style.display="flex",r.setState({popupOn:!r.state.popupOn})},r.changeImg=function(e){var t=document.getElementById(e);document.getElementById("imgDropDown").src=t.src},r.handleFormClicked=function(e){var t=e.target.id;console.log(t),r.changeImg(t),r.props.onFormClicked(t)},r.state={popupOn:!1},r.popup=a.a.createRef(),r}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{ref:this.dropDownBox,className:"DropDown box",onClick:function(t){e.handleClick(t)}},a.a.createElement("img",{id:"imgDropDown"}),a.a.createElement("div",{ref:this.popup,className:"popup box"},a.a.createElement("img",{id:"rectangle",src:B.a,onClick:function(t){e.handleFormClicked(t)}}),a.a.createElement("img",{id:"circle",src:D.a,onClick:function(t){e.handleFormClicked(t)}}),a.a.createElement("img",{id:"straightLine",src:I.a,onClick:function(t){e.handleFormClicked(t)}})))}}]),n}(a.a.Component),M=5,N=20,L=3,F="black",U={x:0,y:0},Y={x:100,y:100},V=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var a;Object(i.a)(this,n),(a=t.call(this,e,o)).reset=function(e){a.props.onResetCanvas()},a.setTool=function(e,t){a.changeLastToolColor(),a.setState({tool:t,lastTool:document.querySelector("#"+t)}),a.changeTool(t),document.querySelector("#"+t).style.stroke="#94d3ac"},a.changeLastToolColor=function(){a.state.lastTool.style.stroke="white"},a.handleWidthChange=function(e,t){"Brush"===t?a.state.line.setWidth(e.state.width):"Form"===t?a.state.form.setWidth(e.state.width):"Eraser"===t&&a.state.lineErase.setWidth(e.state.width)},a.handleColorChange=function(e,t){"Brush"===t?a.state.line.setColor(e.hex):"Form"===t&&a.state.form.setColor(e.hex)},a.changeTool=function(e){a.props.onToolChange(e)},a.hideConfig=function(){document.querySelectorAll(".config").forEach((function(e){e.style.display="none"}))},a.handleArrowOpen=function(e){switch(a.hideConfig(),e.target.id){case"brush-arrow":document.querySelector("#brush-config").style.display="flex";break;case"eraser-arrow":document.querySelector("#eraser-config").style.display="flex";break;case"form-arrow":document.querySelector("#form-config").style.display="flex"}},a.getTools=function(){return{line:a.state.line,lineErase:a.state.lineErase,form:a.state.form}},a.handleFormClicked=function(e){var t=a.state.forms[e];console.log(e),console.log(t),a.setState({form:t}),a.props.onFormChanged(t)};var r=new k(M,M,U,Y),c=new w(N,N,U,Y),s=new O(L,F,U),l=new x(L,F,U),u={circle:s,rectangle:l,straightLine:new S(L,F,U)},h=[r,c,l];return a.state={isDown:!1,tool:"Brush",line:r,lineErase:c,form:l,forms:u,tools:h},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.setState({lastTool:document.querySelector("#Brush")}),document.querySelector("#Brush").style.stroke="#94d3ac",this.hideConfig()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Toolbar-wrapper"},a.a.createElement("div",{id:"brush-config",className:"config"},a.a.createElement(p,{onValueChange:function(t){e.handleWidthChange(t,"Brush")},width:this.state.line.getWidth()}),a.a.createElement(v,{onColorChange:function(t){e.handleColorChange(t,"Brush")}})),a.a.createElement("div",{id:"form-config",className:"config"},a.a.createElement(T,{onFormClicked:function(t){e.handleFormClicked(t)}}),a.a.createElement(p,{onValueChange:function(t){e.handleWidthChange(t,"Form")},width:this.state.form.width}),a.a.createElement(v,{onColorChange:function(t){e.handleColorChange(t,"Form")}})),a.a.createElement("div",{id:"eraser-config",className:"config"},a.a.createElement(p,{onValueChange:function(t){e.handleWidthChange(t,"Eraser")},width:this.state.line.getWidth()})),a.a.createElement("div",{className:"toolbar"},a.a.createElement("div",{className:"tool-container"},a.a.createElement("button",{onClick:function(t){e.setTool(t,"Brush")}},a.a.createElement("svg",{width:"42",height:"215",viewBox:"0 0 42 215",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("g",{filter:"url(#filter0_d)"},a.a.createElement("path",{ref:this.toolBrush,id:"Brush",className:"tool",d:"M5 206V49L21 2L37 49V206H5Z",stroke:"black"})),a.a.createElement("defs",null,a.a.createElement("filter",{id:"filter0_d",x:"0.5",y:"0.448471",width:"41",height:"214.052",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},a.a.createElement("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),a.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.a.createElement("feOffset",{dy:"4"}),a.a.createElement("feGaussianBlur",{stdDeviation:"2"}),a.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),a.a.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),a.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"}))))),a.a.createElement("img",{src:A.a,onClick:function(t){e.handleArrowOpen(t)},className:"toolarrow",id:"brush-arrow"})),a.a.createElement("div",{className:"tool-container"},a.a.createElement("button",{onClick:function(t){e.setTool(t,"Form")}},a.a.createElement("svg",{width:"102",height:"102",viewBox:"0 0 102 102",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{ref:this.toolForm,id:"Form",className:"tool",d:"M101 1H1V101H101V1Z",stroke:"black"}))),a.a.createElement("img",{src:A.a,onClick:function(t){e.handleArrowOpen(t)},className:"toolarrow",id:"form-arrow"})),a.a.createElement("div",{className:"tool-container"},a.a.createElement("button",{onClick:function(t){e.setTool(t,"Eraser")}}," ",a.a.createElement("svg",{width:"91",height:"179",viewBox:"0 0 91 179",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("g",{filter:"url(#filter0_i)"},a.a.createElement("path",{ref:this.toolEraser,id:"Eraser",className:"tool",d:"M1 118V24C47 -27 90 24 90 24V118M1 118V154C45.5 207 90 154 90 154V118M1 118H90",stroke:"black"})),a.a.createElement("defs",null,a.a.createElement("filter",{id:"filter0_i",x:"0.5",y:"0.833313",width:"90",height:"181.222",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},a.a.createElement("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),a.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.a.createElement("feOffset",{dy:"4"}),a.a.createElement("feGaussianBlur",{stdDeviation:"2"}),a.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),a.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))))),a.a.createElement("img",{src:A.a,onClick:function(t){e.handleArrowOpen(t)},className:"toolarrow",id:"eraser-arrow"})),a.a.createElement("div",{className:"tool-container"},a.a.createElement("button",{onClick:function(t){e.reset(t)}},a.a.createElement("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{id:"removeall",className:"tool",d:"M1 1L51 51M1 51L51 1",stroke:"black"}))))))}}]),n}(a.a.Component),W=(n(375),n(409),n(147),n(147),window.constraints={video:!0,audio:!0},n(426),n(8)),Q=n.n(W),G=n(97),z=n(13),H=n(26),X=n.n(H),q=n(44),K=(n(169),n(36)),Z=n.n(K);console.log(q.a.browserDetails.browser),console.log(q.a.browserDetails.version);var J={video:{width:200,height:200},audio:!0},_=!1,$=!1,ee=!1,te=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this)).connect=function(){var e=Object(z.a)(Q.a.mark((function e(t){var n,a,r,c,i;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelector("#localVideo"),e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia(J);case 4:a=e.sent,r=Object(G.a)(a.getTracks());try{for(r.s();!(c=r.n()).done;)i=c.value,o.localPeerConnection.addTrack(i,a)}catch(t){r.e(t)}finally{r.f()}n.srcObject=a,n.play(),n.style.display="inherit",e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:o.setSocketEvents(),o.localPeerConnection.ontrack=o.onTrackHandler,o.localPeerConnection.onnegotiationneeded=o.handleNegotation,o.localPeerConnection.addEventListener("icecandidate",o.handleConnection),o.iceCandidates=[];case 20:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),o.handleNegotation=Object(z.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_=!0,e.next=4,o.localPeerConnection.createOffer();case 4:return t=e.sent,e.next=7,o.localPeerConnection.setLocalDescription(t);case 7:o.socket.emit("offer",o.localPeerConnection.localDescription),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:return e.prev=13,_=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])}))),o.onTrackHandler=function(e){var t=document.querySelector("#remoteVideo");e.track.onunmute=function(){t.srcObject||(t.srcObject=e.streams[0],t.play(),t.style.display="inherit")}},o.setSocketEvents=function(){o.socket.on("messages",function(){var e=Object(z.a)(Q.a.mark((function e(t,n){var a,r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=18;break}if(a="offer"==t.type&&(_||"stable"!=o.localPeerConnection.signalingState),!($=!ee&&a)){e.next=7;break}return console.log("ignored"),e.abrupt("return");case 7:return e.next=9,o.localPeerConnection.setRemoteDescription(t);case 9:if("offer"!=t.type){e.next=16;break}return e.next=12,o.localPeerConnection.createAnswer();case 12:return r=e.sent,e.next=15,o.localPeerConnection.setLocalDescription(r);case 15:o.socket.emit("answer",o.localPeerConnection.localDescription);case 16:e.next=28;break;case 18:if(!n){e.next=28;break}return e.prev=19,e.next=22,o.localPeerConnection.addIceCandidate(n);case 22:e.next=28;break;case 24:if(e.prev=24,e.t0=e.catch(19),$){e.next=28;break}throw e.t0;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(0),console.error(e.t1);case 33:case"end":return e.stop()}}),e,null,[[0,30],[19,24]])})));return function(t,n){return e.apply(this,arguments)}}()),o.socket.on("connect",(function(e){console.log(e)})),o.socket.on("connect_error",(function(e){console.log(e)})),o.socket.on("error",(function(e){console.log(e)})),o.socket.on("created",function(){var e=Object(z.a)(Q.a.mark((function e(t,n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("created"),ee=!0;case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o.socket.on("joined",(function(e,t,n){})),o.socket.on("answer",(function(e,t,n){var a=new RTCSessionDescription(n);o.gotAnswer(a)})),o.socket.on("newicecandidates",(function(e,t,n){console.log("newicecandidates"),console.log(n),o.addIceCandidates(n)})),o.socket.emit("listening")},o.gotLocalMediaStream=function(e){var t,n=document.querySelector("#localVideo"),a=Object(G.a)(e.getTracks());try{for(a.s();!(t=a.n()).done;){var r=t.value;o.localPeerConnection.addTrack(r,e)}}catch(c){a.e(c)}finally{a.f()}n.srcObject=e,n.play(),o.localPeerConnection.addStream(e)},o.handleLocalMediaStreamError=function(e){console.log(e)},o.handleConnection=function(e){e.target;var t=e.candidate;o.socket.emit("icecandidate",t)},o.addIceCandidates=function(e){for(var t=0;t<e.length;t++){var n=e[t];o.addIceCandidate(n)}},o.addIceCandidate=function(e){o.localPeerConnection.addIceCandidate(e).then((function(){o.handleConnectionSuccess(o.localPeerConnection)})).catch((function(e){o.handleConnectionFailure(o.localPeerConnection,e)}))},o.handleConnectionSuccess=function(e){console.log("handle connection success")},o.handleConnectionFailure=function(){console.log("handle connection failure")},o.setDataChannelEvents=function(){o.dataChannel.onmessage=function(e){console.log(e)}},o.getLocalSocket=function(){return X.a.connect("ws://localhost:8000",{reconnect:!0,transports:["websocket"],path:"/socket.io"})},o.getRemoteSocket=function(){return X.a.connect("wss://pizarrabackend.herokuapp.com",{reconnect:!0,transports:["websocket"],path:"/socket.io",protocol:"https:"===window.location.protocol?"wss":"ws"})},o.getMediaConstraints=Object(z.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getMediaPermissions();case 2:return(t=e.sent).video&&(t.video={width:200,height:200}),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),o.getMediaPermissions=Object(z.a)(Q.a.mark((function e(){var t,n,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,navigator.permissions.query({name:"camera"}).then((function(e){n=e.state}));case 3:return e.next=5,navigator.permissions.query({name:"microphone"}).then((function(e){a=e.state}));case 5:return a=o.getDevicePermissions(a),n=o.getDevicePermissions(n),t.video=n,t.audio=a,e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),o.getDevicePermissions=function(e){return"granted"==e},o.localPeerConnection=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}],offerToReceiveVideo:!0,offerToReceiveAudio:!0}),o.socket=e,o}return n}(Z.a);console.log(q.a.browserDetails.browser),console.log(q.a.browserDetails.version);var ne=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this)).connect=function(){var e=Object(z.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.setSocketEvents(),o.dataChannel=o.localPeerConnection.createDataChannel("data",{negotiated:!0,id:0}),o.dataChannel.onopen=function(){o.connected=!0},o.dataChannel.onmessage=function(e){o.handleDataMessage(e)},o.localPeerConnection.onnegotiationneeded=o.handleNegotation,o.localPeerConnection.addEventListener("icecandidate",o.handleConnection);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.handleNegotation=Object(z.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.localPeerConnection.createOffer();case 3:return t=e.sent,e.next=6,o.localPeerConnection.setLocalDescription(t);case 6:o.socket.emit("dataoffer",o.localPeerConnection.localDescription),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),o.updateCanvas=function(e){o.sendData("canvas",e)},o.sendData=function(e,t){o.connected&&o.dataChannel.send(JSON.stringify({type:e,data:t}))},o.handleDataMessage=function(e){var t=JSON.parse(e.data);"canvas"==t.type&&o.emit("canvas",t.data)},o.handleConnection=function(e){e.target;var t=e.candidate;o.socket.emit("dataicecandidate",t)},o.setSocketEvents=function(){o.socket.on("datamessages",function(){var e=Object(z.a)(Q.a.mark((function e(t,n){var a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=13;break}return e.next=4,o.localPeerConnection.setRemoteDescription(t);case 4:if("offer"!=t.type){e.next=11;break}return e.next=7,o.localPeerConnection.createAnswer();case 7:return a=e.sent,e.next=10,o.localPeerConnection.setLocalDescription(a);case 10:o.socket.emit("dataanswer",o.localPeerConnection.localDescription);case 11:e.next=23;break;case 13:if(!n){e.next=23;break}return e.prev=14,e.next=17,o.localPeerConnection.addIceCandidate(n);case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(14),e.t0;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),console.error(e.t1);case 28:case"end":return e.stop()}}),e,null,[[0,25],[14,19]])})));return function(t,n){return e.apply(this,arguments)}}()),o.socket.on("connect",(function(e){console.log(e)})),o.socket.on("connect_error",(function(e){console.log(e)})),o.socket.on("error",(function(e){console.log(e)})),o.socket.on("created",function(){var e=Object(z.a)(Q.a.mark((function e(t,n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!0;case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o.socket.on("joined",(function(e,t,n){})),o.socket.on("dataanswer",(function(e,t,n){var a=new RTCSessionDescription(n);o.gotAnswer(a)})),o.socket.on("datanewicecandidates",(function(e,t,n){o.addIceCandidates(n)}))},o.addIceCandidates=function(e){for(var t=0;t<e.length;t++){var n=e[t];o.addIceCandidate(n)}},o.addIceCandidate=function(e){o.localPeerConnection.addIceCandidate(e).then((function(){o.handleConnectionSuccess(o.localPeerConnection)})).catch((function(e){o.handleConnectionFailure(o.localPeerConnection,e)}))},o.handleConnectionSuccess=function(e){console.log("handle connection success")},o.handleConnectionFailure=function(){console.log("handle connection failure")},o.setDataChannelEvents=function(){o.dataChannel.onmessage=function(e){console.log(e)}},o.getLocalSocket=function(){return X.a.connect("ws://localhost:8000",{reconnect:!0,transports:["websocket"],path:"/socket.io"})},o.getLocalConnection=function(){return X.a.connect("ws://localhost:8000",{reconnect:!0,transports:["websocket"],path:"/socket.io",protocol:"https:"===window.location.protocol?"wss":"ws"})},o.getRemoteSocket=function(){return X.a.connect("wss://pizarrabackend.herokuapp.com",{reconnect:!0,transports:["websocket"],path:"/socket.io",protocol:"https:"===window.location.protocol?"wss":"ws"})},o.getMediaConstraints=Object(z.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getMediaPermissions();case 2:return(t=e.sent).video&&(t.video={width:200,height:200}),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),o.getMediaPermissions=Object(z.a)(Q.a.mark((function e(){var t,n,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,navigator.permissions.query({name:"camera"}).then((function(e){n=e.state}));case 3:return e.next=5,navigator.permissions.query({name:"microphone"}).then((function(e){a=e.state}));case 5:return a=o.getDevicePermissions(a),n=o.getDevicePermissions(n),t.video=n,t.audio=a,e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),o.getDevicePermissions=function(e){return"granted"==e},o.localPeerConnection=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),o.socket=e,o}return n}(Z.a),oe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var a;return Object(i.a)(this,n),(a=t.call(this,e,o)).updateCanvas=function(e){a.dataConnection.updateCanvas(e)},a.getLocalSocket=function(){return X.a.connect("ws://localhost:8000",{reconnect:!0,transports:["websocket"],path:"/socket.io"})},a.getRemoteSocket=function(){return X.a.connect("wss://pizarrabackend.herokuapp.com",{reconnect:!0,transports:["websocket"],path:"/socket.io",protocol:"https:"===window.location.protocol?"wss":"ws"})},a.connect=function(e){console.log(e),a.socket.emit("joinroom",e),a.connection.connect(e),a.dataConnection.connect(e)},a.state={room:e.room},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.initializeConnection(),this.connect(this.state.room)}},{key:"initializeConnection",value:function(){var e=this,t=document.querySelector("#localVideo"),n=document.querySelector("#remoteVideo");console.log(n,t),this.socket=this.getRemoteSocket(),this.connection=new te(this.socket),this.dataConnection=new ne(this.socket),this.dataConnection.on("canvas",(function(t){e.props.onCanvasUpdate(t)}))}},{key:"render",value:function(){return a.a.createElement("div",{id:"room"},a.a.createElement("video",{id:"localVideo",className:"box",muted:!0}),a.a.createElement("video",{id:"remoteVideo",className:"box"}),a.a.createElement("audio",{id:"remoteAudio"}))}}]),n}(a.a.Component);function ae(e,t){return{x:t.clientX,y:t.clientY}}window.constraints={video:!0,audio:!0};var re=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var r;return Object(i.a)(this,n),(r=t.call(this,e,o)).setListener=function(){document.addEventListener("keydown",(function(e){return r.isKeysCombination(e)}))},r.isKeysCombination=function(e){e.ctrlKey&&"z"===e.key?r.canvasUndo():e.ctrlKey&&"y"===e.key&&r.canvasRedo()},r.canvasPush=function(){var e=document.getElementById("Board").toDataURL();r.roomConnection.current.updateCanvas(e),0==r.state.pos?r.updatePushArray(e):(r.removeUnusedElements(e),r.setState({pos:0}))},r.toStringCanvas=function(){for(var e=r.state.pushArray,t=0;t<e.length;t++)console.log(t),console.log(e[t])},r.updatePushArray=function(e){var t=new Array(r.state.pushArray.length);t[0]=e;for(var n=1;n<r.state.pushArray.length;n++)t[n]=r.state.pushArray[n-1];r.setState({pushArray:t})},r.removeUnusedElements=function(e){var t=r.state.pushArray,n=t.length-(t.length-r.state.pos);t[0]=e;for(var o=1;o<t.length;o++)t.length>n+o?t[o]=r.state.pushArray[n+o-1]:t[o]=void 0;r.setState({pushArray:t})},r.canvasUndo=function(){var e=r.state.pos,t=r.state.pushArray;if(e<t.length){r.state.canvas.getContext("2d"),new Image;void 0!=t[++e]&&r.updateCanvas(t[e]),r.setState({pos:e})}},r.canvasRedo=function(){var e=r.state.pos,t=r.state.pushArray;e>0&&(void 0!=t[--e]&&r.updateCanvas(t[e]),r.setState({pos:e}))},r.updateCanvas=function(e){var t=r.state.canvas.getContext("2d"),n=new Image;n.addEventListener("load",(function(e){r.reset(),t.drawImage(n,0,0)})),n.src=e},r.initializeRefs=function(){r.canvas=a.a.createRef(),r.toolBrush=a.a.createRef(),r.toolEraser=a.a.createRef(),r.toolForm=a.a.createRef(),r.toolbar=a.a.createRef(),r.roomConnection=a.a.createRef()},r.getCanvas=function(){return r.canvas},r.getTools=function(){return r.state.tools},r.setToolsCanvas=function(e){var t=r.toolbar.current.getTools();e=r.getCanvas().current;for(var n in t){t[n].setCanvas(e)}},r.mouseDown=function(e){r.toolbar.current.hideConfig(),r.setMouseIsDown(!0),r.initializePaths(e)},r.setMouseIsDown=function(e){r.setState({isDown:e})},r.initializePaths=function(e){r.initializePathBrush(e),r.initializePathForm(e),r.initializePathEraser(e)},r.initializePathEraser=function(e){var t=ae(r.state.line.getCanvas(),e);r.state.lineErase.getContext().beginPath(),r.state.lineErase.updateLine(t)},r.initializePathBrush=function(e){var t=ae(r.state.line.getCanvas(),e);r.state.line.getContext().beginPath(),r.state.line.updateLine(t)},r.initializePathForm=function(e){var t=ae(r.state.line.getCanvas(),e);r.state.form.getContext().beginPath(),r.state.form.setPosActual(t)},r.mouseUp=function(e){var t=ae(r.state.canvas,e);if(r.setMouseIsDown(!1),"Form"==r.state.tool){t=ae(r.state.canvas,e);r.state.form.actualizarPos(t),r.state.form.draw()}r.closePaths()},r.closePaths=function(){r.state.form.getContext().closePath(),r.state.line.getContext().closePath(),r.state.lineErase.getContext().closePath()},r.mouseMove=function(e){if(r.state.isDown)switch(r.state.tool){case"Brush":r.brush(e);break;case"Eraser":r.erase(e);break;case"Form":r.form(e)}},r.reset=function(e){r.state.canvas.getContext("2d").clearRect(0,0,r.state.canvas.width,r.state.canvas.height)},r.erase=function(e){var t=ae(r.state.canvas,e);r.state.lineErase.setMode("erase"),r.state.lineErase.updateLine(t),r.state.lineErase.draw()},r.form=function(){},r.brush=function(e){var t=ae(r.state.canvas,e);r.state.line.setMode("brush"),r.state.line.updateLine(t),r.state.line.draw()},r.handleToolModified=function(e,t){switch(t){case"Brush":r.changeBrush(e);break;case"Eraser":r.changeEraser(e);break;case"Form":r.changeForm(e)}},r.changeBrush=function(e){r.setState({line:e})},r.changeEraser=function(e){r.setState({lineErase:e})},r.changeForm=function(e){r.setState({form:e}),e.setCanvas(r.canvas.current)},r.handleToolChange=function(e){r.setState({tool:e})},r.initializeRefs(),r.state={isDown:!1,tool:"Brush",room:e.room,pushArray:new Array(15),pos:0},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.toolbar.current.getTools(),t=e.line,n=e.lineErase,o=e.form;this.setState({canvas:this.canvas.current,line:t,lineErase:n,form:o,tools:e}),this.setToolsCanvas(this.getCanvas()),this.setListener()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Board"},a.a.createElement("canvas",{ref:this.canvas,id:"Board",height:"1080px",width:"1920px",onMouseDown:function(t){return e.mouseDown(t)},onMouseUp:function(t){return e.mouseUp(t)},onMouseMove:function(t){return e.mouseMove(t)},onClick:function(){return e.canvasPush()}}),a.a.createElement(V,{ref:this.toolbar,onToolModified:function(t,n){e.handleToolModified(t,n)},onToolChange:function(t){e.handleToolChange(t)},onResetCanvas:function(){e.reset()},onFormChanged:function(t){e.changeForm(t)}}),a.a.createElement(oe,{ref:this.roomConnection,room:this.state.room,onCanvasUpdate:function(t){e.updateCanvas(t)}}),"/>")}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(450);var ce=n(33),ie=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var a;return Object(i.a)(this,n),(a=t.call(this,e,o)).state={redirect:!1,idRoom:void 0},a.connect=function(){var e=document.querySelector("#idroom").value;a.setState({redirect:!0,idRoom:e})},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.redirect,n=e.idRoom;return t?a.a.createElement(ce.a,{component:function(){return a.a.createElement(re,{room:n})}}):a.a.createElement("div",{id:"mainpage"},a.a.createElement("textarea",{id:"idroom",className:"box",placeholder:"Number of room"}),a.a.createElement("button",{onClick:this.connect},"Connect"))}}]),n}(a.a.Component),se=n(37),le=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,o){var a;return Object(i.a)(this,n),(a=t.call(this,e,o)).connect=function(){var e=document.querySelector("#idroom").value;a.idRoom=e},a.idRoom=3,a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return a.a.createElement(se.a,null,a.a.createElement("div",null,a.a.createElement(ce.c,null,a.a.createElement(ce.a,{path:"/"},a.a.createElement(ie,null)),a.a.createElement(ce.a,{path:"/room/".concat(this.idRoom)},a.a.createElement(re,null)))))}}]),n}(a.a.Component);c.a.render(a.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},65:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG/SURBVHgB3ZqBTcMwEEUdiQEYoZvQTcoIbEA36AgZBZiAEcIGsMHhU78l60hR4vrsO3/JapomPr++yE3ShDByiGiO7RRGS4Q60jXLcIAR6A3mlqEAYe0Ty89DAcLaKXs/BiCsLSvr/QNKa+Izv4C3rIltfALC2suG7XwBwtp3bI8bt/cDCGuvO/exD7jXmtjXNmCJNbG/TcA4mEOpNdGPPUCcPxZbE33ZAaxlTfRpA7CmNdFvX0ANa6L/foCx4EXDmqjRHpBtoaCKNVGrLSAb07Ym6rUBbGlN1NUHbG1N1NYDhDWeIQ+hU9QAYW0OnVMd0IK1PGuAD6EsPHn8BDv5QgvZ6/7Eb+Vs5FA80vXSittTuCc4vVo6Tx71gLJO5162VIDQMdui1rbUgLICTW2pA6FIM1tNgLJibOsSFNMUCAVVZ8LmQFnhmXRuDfQBQvHqtroCZYOoZssEEAZSxZYZoGxAM91xOWAOiJNshYKYBEopsWUaiLPXlnmglK223ABxaNuf636AUuj/xyH8AXHo9gMsPoFS6O8jR76BOIRbWFh2DzSlBUC9x3bAqvM0TR/Bc2CLXB9ya8Hv1jhAI+cX5JMx4SG/+OIAAAAASUVORK5CYII="}},[[179,1,2]]]);
//# sourceMappingURL=main.ff01d02d.chunk.js.map